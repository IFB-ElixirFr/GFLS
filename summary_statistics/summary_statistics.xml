<!--# Copyright (C) 2014 INRA
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see http://www.gnu.org/licenses/.
#-->
<tool id="summary_statistics" name="Summary statistics">
    <description>(beta version)</description>
          <command interpreter="perl">summary_statistics.pl 
          --filein $file_in 
          --NAcode $NA_code          
          --statcondstat $stat_cond.stat
          #if $stat_cond.stat =="T":
             --statcondstatchosen $stat_cond.stat_chosen
          #end if 
          --plotingcondploting  $ploting_cond.ploting 
          #if $ploting_cond.ploting =="T":
             --plotingcondplotchosen  $ploting_cond.plot_chosen
          #end if
          --outputfile $outputfile  
           </command>
                  <inputs>
                        <param format="csv, txt" name="file_in" type="data" label="Input File"/>
                        <param name="NA_code" size="30" type="text" value="NA" label="Label used for Missing values"/>                        
                        
                        <conditional name="stat_cond">
                                   <param name="stat" type="select" help="Do you want to compute some basic statistics?" label="Statistics table">
                                       <option value="T">Yes</option>
                                       <option value="F" selected="true">No</option>
                                   </param> 
                             <!-- <when value="F">
                             <validator type="empty_field" message="Your job can not be sent if you do not choose a stat representation." />
                             </when> -->
                             <when value="T">
                                <param name="stat_chosen" type="select" display="checkboxes" multiple="True" label="Chosen statistic(s)">
                                   <option value="mean">mean</option>
                                   <option value="sd">sd</option>
                                   <option value="variance">variance</option>
                                   <option value="median">median</option>
                                   <option value="quartile">quartile</option>
                                   <option value="decile">decile</option>   
                                   <validator type="empty_field" message="Please choose at least one statistic representation" />
                                 </param>
                                </when>
                        </conditional>
                         
                        <conditional name="ploting_cond">
                                   <param name="ploting" type="select" help="Do you want some standard plots?" label="Plots">
                                       <option value="T">Yes</option>
                                       <option value="F" selected="true">No</option>
                                   </param> 
                            <!-- <when value="F">
                             <validator type="empty_field" message="Your job can not be sent if you do not choose a plot representation." />
                             </when> -->
                             <when value="T">
                                <param name="plot_chosen" type="select" help=""  display="checkboxes" multiple="True" label="Chosen plot(s)">
                                     <option value="boxplot">boxplot</option>
                                     <option value="histogram">histogram</option>
                                     <option value="density">density</option>
                                     <option value="pairsplot">pairsplot</option>
                                    <option value="MAplot">MAplot</option>                                                                                                                      
                                <validator type="empty_field" message="Please choose at least one ploting representation." />
                                </param>
                             </when>
                       </conditional>            
                  </inputs>
                  <outputs>
                     <data format="html" name="outputfile" label ="Summary_statistics_report.html"/>
                  </outputs>
  <help>

.. class:: infomark

**What this tool does:**

This program produces simple descriptive statistics from a numeric table. Statistical measures are computed for each column in the table.



------------------
Input/output files
------------------

The input file must be a tabulation-separated table (text file with columns being separated by a tabulation).

The first line should be a header (naming columns) and each line must begin with a row name, like the example below: 

.. image:: ${static_path}/operation_icons/input_count_file.png


This tool produces a html file displaying the results, where two kinds of output are available:
	| - numerical values (as a table)
	| - graphics

You can also download the table and plots *via* links found in this html file. 




------------------------------
Available statistics and plots
------------------------------

**Numerical statistical measures provided are the following ones:**


.. image:: ${static_path}/operation_icons/descriptive_stat_1.png
        :width: 500


**Available plots:**


	* boxplot


.. image:: http://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/images/schematic.png

(source : SAS documentation)

	* histogram


.. image:: ${static_path}/operation_icons/descriptive_stat_histo.png
        :width: 285

In this example, about 45 values of the dataset are greater than 0 and lower than 0.5

	* density


.. image:: ${static_path}/operation_icons/descriptive_stat_density.png
        :width: 275

This option computes kernel density estimates (gaussian smoothing).
While a histogram displays the observed distribution of a numerical variable, a density plot allows to view the estimated distribution of the theoretical continuous variable. 

	* pairsplot


.. image:: ${static_path}/operation_icons/descriptive_stat_pairs.png
        :width: 475

In this example, we have represented a pairs plot for a table with three columns, named 
"a", "b" and "c". Each plot represents the values of a given column scaled on the x axis versus
the values of another column scaled on the y axis.

	* MAplot


.. image:: ${static_path}/operation_icons/descriptive_stat_maplot.png
        :width: 275

Designed for genomic data (count data - only positive values accepted).
Each plot allows to compare two samples. 
The ordinate axis (M) represents the log ratios (binary logarithm) whereas the abscissa axis (A) corresponds to the means of log values. 


---------------------------------------------------

.. class:: infomark

Information

Galaxy tool developed by Luc Jouneau, Sarah Maman and Mélanie Pétéra as part of the CATI:Bios4Biol statistical group. 
Re-packaging provided by Valentin Marcon as part of the Galaxy For Life Science project. 

E-learning available: Not yet.

Tool coded in the R language:
	| *R Core Team. R: A language and environment for statistical computing. R*
	| *Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.*

Acknowledgements:
	| *We wish to thank the SIGENAE group for their support [ http://www.sigenae.org/ ]*


  </help>
</tool>
